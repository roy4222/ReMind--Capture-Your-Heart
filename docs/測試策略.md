# ReMind 測試策略與報告

> **專案名稱**：ReMind - Capture Your Heart  
> **測試版本**：n8n@2.1.1 (Self Hosted)  
> **最後測試日期**：2025/12/27

---

## 📊 測試總覽

| 測試項目 | 狀態 | 測試日期 |
|----------|------|----------|
| 測試 1: 模型穩定性 + UI 呈現 | ✅ 通過 | 2025/12/27 |
| 測試 2: 深度記憶提取 | 🔄 待測試 | - |
| 測試 3: 無效事實過濾 | ✅ 通過 | 2025/12/27 |
| 測試 4: 多用戶記憶隔離 | 🔄 待測試 | - |
| 測試 5: 連續對話穩定性 | 🔄 待測試 | - |

---

## ✅ 測試 1: 模型穩定性 + UI 呈現

### 目的
確認模型切換成功 & Embed 卡片正常顯示

### 測試步驟
1. 用你的 Discord 帳號私訊 Bot：「你好」
2. 觀察回覆

### 預期結果
| 項目 | 預期 | 實際結果 |
|------|------|----------|
| 回應時間 | 3-5 秒內 | ✅ 約 2.3 秒 |
| 呈現格式 | Embed 卡片 | ✅ 正確顯示 |
| 側邊條顏色 | 紫色（預設） | ✅ 正確 |
| Footer | 💭 ReMind - 你的 AI 記憶夥伴 | ✅ 正確 |

### 顏色動態測試

| 訊息內容 | 預期顏色 | 結果 |
|----------|----------|------|
| 「明天天氣如何？」（含 `?`） | 藍色 | 🔄 待測試 |
| 「太棒了！」（含 `!`） | 橘色 | 🔄 待測試 |

### 測試記錄
- **測試時間**：2025/12/27 22:37
- **Bot 回覆**：「抱歉，我找不到您的任何記錄 🥺。這是因為我們才剛開始聊天，還沒有任何的對話記錄 📝。如果您願意分享，您可以告訴我一些關於您的資訊，例如您的名字、興趣等 😊。這樣我就可以更好地認識您並提供個性化的聊天體驗 😊。」
- **狀態**：✅ **通過**

---

## 🔄 測試 2: 深度記憶提取

### 目的
確認事實提取包含完整上下文

### 測試步驟
1. 發送：「我的貓叫小白，牠超級可愛」
2. 等待 Bot 回應
3. 等待 5-10 秒，讓記憶系統處理
4. 發送：「我的寵物叫什麼名字？」

### 預期結果
| 項目 | 預期 |
|------|------|
| 回答寵物名字 | Bot 正確回答「小白」 |
| 細節回憶 | 可能提及「可愛」等細節 |
| Qdrant 記錄 | 新增「用戶的貓叫做小白」 |

### 測試記錄
- **狀態**：🔄 待測試

---

## ✅ 測試 3: 無效事實過濾

### 目的
確認 IF 節點正常過濾無意義對話

### 測試步驟
發送閒聊訊息：
- 「嗨」
- 「哈囉」
- 「天氣真好」
- 「哈哈哈哈」

### 預期結果
| 項目 | 預期 | 實際結果 |
|------|------|----------|
| Bot 回應 | 正常回應所有訊息 | ✅ 正確 |
| Qdrant 記錄 | 不新增無意義內容 | ✅ 正確過濾 |

### 測試記錄
- **測試時間**：2025/12/27 22:37
- **過濾節點輸出**：記憶區輸出「NONE」，被過濾無效事實節點正確攔截
- **Qdrant 狀態**：未新增無效記錄
- **狀態**：✅ **通過**

---

## 🔄 測試 4: 多用戶記憶隔離 ⭐ 重要

### 目的
確認 Metadata Filter 修復成功，A 的記憶不會洩漏給 B

### 需要準備
- 兩個不同的 Discord 帳號（帳號 A 和帳號 B）

### 測試步驟

| 步驟 | 操作 | 預期結果 |
|------|------|----------|
| 1 | 【帳號 A】私訊：「我叫小明，我喜歡打籃球」 | Bot 回應確認 |
| 2 | 【帳號 A】私訊：「我喜歡什麼運動？」 | Bot 回答「籃球」 |
| 3 | 【帳號 B】私訊：「小明喜歡什麼運動？」 | Bot 說「我不知道」 |
| 4 | 【帳號 B】私訊：「我是誰？」 | Bot 說「我還不認識你」 |

### 驗收標準
- [ ] 帳號 A 能讀取自己的記憶
- [ ] 帳號 B 完全無法讀取帳號 A 的任何資訊
- [ ] 兩個帳號的記憶完全獨立

### 測試記錄
- **狀態**：🔄 待測試

---

## 🔄 測試 5: 連續對話穩定性

### 目的
確認系統在多輪對話中穩定運行

### 測試步驟
連續發送 10 條訊息：

| # | 訊息內容 |
|---|----------|
| 1 | 我今天很累 |
| 2 | 因為加班到很晚 |
| 3 | 我在做專案報告 |
| 4 | 明天要交給老師 |
| 5 | 你覺得我應該繼續嗎？ |
| 6 | 好吧，我再努力一下 |
| 7 | 對了，我明天要早起 |
| 8 | 7 點要開會 |
| 9 | 你記得我明天幾點開會嗎？ |
| 10 | 謝謝你的陪伴 |

### 預期結果
| 項目 | 預期 |
|------|------|
| 回應率 | 100% 正常回應 |
| 錯誤/超時 | 0 次 |
| 第 9 條記憶測試 | Bot 能回答「7 點」 |
| 格式 | 全部 Embed 卡片 |

### 測試記錄
- **狀態**：🔄 待測試

---

## 📈 n8n 執行效能報告

### 2025/12/27 22:37 測試結果

| 節點名稱 | 執行時間 | Token 使用量 | 狀態 |
|----------|----------|--------------|------|
| Discord Trigger | 4.175s | - | ✅ Success |
| 回應區 | 2.322s | 735 Tokens | ✅ Success |
| Simple Memory | 1ms | - | ✅ Success |
| Groq Chat Model | 388ms | 648 Tokens | ✅ Success |
| Qdrant Vector Store | 1.436s | - | ✅ Success |
| Embeddings Cohere | 427ms | - | ✅ Success |
| 記憶區 | 324ms | 147 Tokens | ✅ Success |
| Groq Chat Model1 | 308ms | - | ✅ Success |
| 過濾無效事實 | 1ms | - | ✅ Success |
| Qdrant Vector Store1 | 1.007s | - | ✅ Success |
| Default Data Loader | 2ms | - | ✅ Success |
| Recursive Character Text Splitter | 0ms | - | ✅ Success |
| Embeddings Cohere1 | 211ms | - | ✅ Success |
| Send a message | 900ms | - | ✅ Success |

**總執行時間**：8.868s  
**總 Token 使用**：1,530 Tokens

---

## 🔧 快速檢查清單

### 功能性
- [x] 對話回應正常，無模型錯誤
- [x] 無效閒聊不會存入資料庫
- [ ] 能正確記住並回憶事實
- [ ] 多用戶記憶完全隔離

### UI/UX
- [x] 所有訊息都以 Embed 卡片呈現
- [ ] 顏色根據內容動態變化（藍/橘/紫）
- [x] Footer 正確顯示「💭 ReMind - 你的 AI 記憶夥伴」

### 穩定性
- [ ] 連續 10 輪對話無錯誤
- [x] n8n 執行日誌無警告或錯誤訊息

---

## 🚨 常見問題排查

### 問題 1: Bot 沒有回應
**檢查**：
- Discord Trigger 是否啟動
- n8n 工作流是否正在運行

### 問題 2: 回覆仍是純文字，不是 Embed
**檢查**：
- 確認有重新載入 JSON 文件
- 檢查 n8n 中「Send a message」節點的 options 欄位

### 問題 3: 模型回應超時或 404
**解決**：
- 檢查 Groq API 是否有額度
- 如果 llama-3.3 不支援，改用 `llama-3.1-70b-versatile`

### 問題 4: 記憶沒有被保存
**檢查**：
- Qdrant API 憑證是否正確
- 檢查「過濾無效事實」節點是否正確連接

### 問題 5: Cannot send an empty message
**解決**：
- 使用 `$json.output` 而非 `$node["節點名"].json.output`
- 詳見開發日記 2025/12/27

---

## 💡 測試建議順序

```
測試 1 → 確認基本功能
    ↓
測試 3 → 確認過濾機制
    ↓
測試 2 → 確認記憶功能
    ↓
測試 4 → 確認隔離（需要兩個帳號）
    ↓
測試 5 → 確認穩定性
```

---

*最後更新：2025/12/27 22:38*  
*記錄者：Antigravity*